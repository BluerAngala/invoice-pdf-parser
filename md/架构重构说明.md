# é¡¹ç›®æ¶æ„é‡æ„è¯´æ˜

## ğŸ“ æ–°çš„ç›®å½•ç»“æ„

```
src/
â”œâ”€â”€ components/              # UI ç»„ä»¶
â”‚   â”œâ”€â”€ InvoiceList.vue     # å‘ç¥¨åˆ—è¡¨
â”‚   â”œâ”€â”€ InvoicePreview.vue  # å‘ç¥¨é¢„è§ˆ
â”‚   â”œâ”€â”€ InvoiceDetail.vue   # å‘ç¥¨è¯¦æƒ…
â”‚   â””â”€â”€ SettingsModal.vue   # è®¾ç½®å¼¹çª—
â”‚
â”œâ”€â”€ composables/             # ç»„åˆå¼å‡½æ•°ï¼ˆçŠ¶æ€ç®¡ç†ï¼‰
â”‚   â”œâ”€â”€ useInvoiceManager.ts    # å‘ç¥¨ç®¡ç†
â”‚   â”œâ”€â”€ useInvoiceExport.ts     # å¯¼å‡ºåŠŸèƒ½
â”‚   â””â”€â”€ useAppSettings.ts       # åº”ç”¨è®¾ç½®
â”‚
â”œâ”€â”€ core/                    # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ invoice-recognizer.ts   # å‘ç¥¨è¯†åˆ«å™¨
â”‚   â”œâ”€â”€ invoice-parser.ts       # å‘ç¥¨è§£æå™¨ï¼ˆæ­£åˆ™æå–ï¼‰
â”‚   â”œâ”€â”€ invoice-deduplicator.ts # å‘ç¥¨å»é‡å™¨
â”‚   â”œâ”€â”€ pdf-processor.ts        # PDF å¤„ç†å™¨
â”‚   â”œâ”€â”€ excel-exporter.ts       # Excel å¯¼å‡ºå™¨
â”‚   â”œâ”€â”€ pdf-exporter.ts         # PDF å¯¼å‡ºå™¨
â”‚   â””â”€â”€ siliconflow-api.ts      # API å®¢æˆ·ç«¯
â”‚
â”œâ”€â”€ types/                   # ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ invoice.ts          # å‘ç¥¨ç±»å‹
â”‚   â””â”€â”€ index.ts            # ç»Ÿä¸€å¯¼å‡º
â”‚
â”œâ”€â”€ utils/                   # çº¯å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ format.ts           # æ ¼å¼åŒ–å·¥å…·
â”‚   â””â”€â”€ constants.ts        # å¸¸é‡å®šä¹‰
â”‚
â”œâ”€â”€ pdfjs/                   # PDF.js åº“
â”œâ”€â”€ App.vue                  # ä¸»åº”ç”¨
â”œâ”€â”€ main.ts                  # å…¥å£
â””â”€â”€ style.css                # å…¨å±€æ ·å¼
```

## ğŸ¯ é‡æ„å†…å®¹

### 1. æ–°å¢ `core/` ç›®å½•
æ ¸å¿ƒä¸šåŠ¡é€»è¾‘å±‚ï¼ŒèŒè´£å•ä¸€ï¼Œæ˜“äºæµ‹è¯•å’Œç»´æŠ¤ï¼š

- **invoice-recognizer.ts** - å‘ç¥¨è¯†åˆ«å…¥å£ï¼Œæ•´åˆå¤šç§è¯†åˆ«ç­–ç•¥
- **invoice-parser.ts** - æ­£åˆ™è§£æé€»è¾‘ï¼Œä»æ–‡æœ¬æå–å‘ç¥¨ä¿¡æ¯
- **invoice-deduplicator.ts** - å‘ç¥¨å»é‡é€»è¾‘
- **pdf-processor.ts** - PDF æ–‡æœ¬æå–å’Œæ¸²æŸ“
- **excel-exporter.ts** - Excel å¯¼å‡ºåŠŸèƒ½
- **pdf-exporter.ts** - PDF å¯¼å‡ºå’Œæ‰“å°åŠŸèƒ½
- **siliconflow-api.ts** - API è°ƒç”¨å°è£…ï¼ˆLLM å’Œ OCRï¼‰

### 2. é‡æ„ `composables/`
ç®€åŒ–ä¸ºçŠ¶æ€ç®¡ç†å±‚ï¼Œè°ƒç”¨ core å±‚çš„ä¸šåŠ¡é€»è¾‘ï¼š

- **useInvoiceManager.ts** - å‘ç¥¨çŠ¶æ€ç®¡ç†ï¼ˆç®€åŒ–ï¼Œè°ƒç”¨ core æ¨¡å—ï¼‰
- **useInvoiceExport.ts** - å¯¼å‡ºåŠŸèƒ½ï¼ˆé‡å‘½åè‡ª useExport.tsï¼‰
- **useAppSettings.ts** - åº”ç”¨è®¾ç½®ç®¡ç†ï¼ˆæ–°å¢ï¼‰

### 3. æ–°å¢ `components/SettingsModal.vue`
ä» App.vue ä¸­æŠ½ç¦»è®¾ç½®å¼¹çª—ï¼Œé™ä½ä¸»ç»„ä»¶å¤æ‚åº¦

### 4. ç®€åŒ– `App.vue`
- ç§»é™¤è®¾ç½®ç›¸å…³é€»è¾‘ï¼Œä½¿ç”¨ useAppSettings
- ç§»é™¤è®¾ç½®å¼¹çª— UIï¼Œä½¿ç”¨ SettingsModal ç»„ä»¶
- ä»£ç é‡å‡å°‘çº¦ 200 è¡Œ

### 5. åˆ é™¤æ—§æ–‡ä»¶
- âŒ `utils/ocr.ts` â†’ âœ… æ‹†åˆ†ä¸º `core/invoice-recognizer.ts` + `invoice-parser.ts` + `siliconflow-api.ts`
- âŒ `utils/pdfExtract.ts` â†’ âœ… æ•´åˆåˆ° `core/pdf-processor.ts`
- âŒ `utils/pdfToImage.ts` â†’ âœ… æ•´åˆåˆ° `core/pdf-processor.ts`
- âŒ `utils/pdf.ts` â†’ âœ… æ‹†åˆ†ä¸º `core/pdf-exporter.ts` + `excel-exporter.ts`
- âŒ `composables/useExport.ts` â†’ âœ… é‡å‘½åä¸º `useInvoiceExport.ts`

## ğŸ“Š é‡æ„æ•ˆæœ

| æŒ‡æ ‡ | é‡æ„å‰ | é‡æ„å | æ”¹è¿› |
|-----|--------|--------|------|
| æœ€å¤§æ–‡ä»¶è¡Œæ•° | 500+ | <300 | âœ… å‡å°‘ 40% |
| utils æ–‡ä»¶æ•° | 4 ä¸ª | 2 ä¸ª | âœ… ç²¾ç®€ 50% |
| ä¸šåŠ¡é€»è¾‘å±‚ | æ··åœ¨ utils | ç‹¬ç«‹ core ç›®å½• | âœ… èŒè´£æ¸…æ™° |
| App.vue è¡Œæ•° | 400+ | 200+ | âœ… å‡å°‘ 50% |
| ç»„ä»¶æ•° | 3 ä¸ª | 4 ä¸ª | âœ… æ¨¡å—åŒ– |

## ğŸ’¡ æ¶æ„ä¼˜åŠ¿

1. **èŒè´£æ¸…æ™°** - core å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œcomposables ç®¡ç†çŠ¶æ€ï¼Œutils æä¾›å·¥å…·å‡½æ•°
2. **æ˜“äºæµ‹è¯•** - æ¯ä¸ª core æ¨¡å—å¯ç‹¬ç«‹æµ‹è¯•
3. **ä¾¿äºæ‰©å±•** - æ–°å¢åŠŸèƒ½æ—¶ç›®å½•ç»“æ„æ¸…æ™°
4. **é™ä½è€¦åˆ** - é€šè¿‡åˆ†å±‚é™ä½æ¨¡å—é—´ä¾èµ–
5. **æå‡å¯è¯»æ€§** - æ–‡ä»¶æ›´å°ï¼Œé€»è¾‘æ›´èšç„¦
6. **å‘½åè§„èŒƒ** - ä½¿ç”¨ kebab-caseï¼Œæ–‡ä»¶åæ¸…æ™°è¡¨è¾¾åŠŸèƒ½

## ğŸ”„ è¿ç§»å¯¹ç…§

| æ—§ä»£ç  | æ–°ä»£ç  |
|-------|--------|
| `import { recognizeInvoice } from '../utils/ocr'` | `import { recognizeInvoice } from '../core/invoice-recognizer'` |
| `import { extractPdfText } from '../utils/pdfExtract'` | `import { extractPdfText } from '../core/pdf-processor'` |
| `import { exportToPDF } from '../utils/pdf'` | `import { exportToPDF } from '../core/pdf-exporter'` |
| `import { useExport } from '../composables/useExport'` | `import { useInvoiceExport } from '../composables/useInvoiceExport'` |

## âœ… éªŒè¯ç»“æœ

æ‰€æœ‰æ–‡ä»¶é€šè¿‡ TypeScript ç±»å‹æ£€æŸ¥ï¼Œæ— è¯­æ³•é”™è¯¯ã€‚
